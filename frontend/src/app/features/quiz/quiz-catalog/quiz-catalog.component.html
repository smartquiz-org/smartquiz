<div class="catalog-page" data-testid="quiz-catalog">
  <!-- Header Section -->
  <header class="catalog-header">
    <!-- Badge -->
    <div class="header-badge glass">
      <svg class="w-4 h-4 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 3l2.5 2.5M12 3v10m0-10l-2.5 2.5M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7"/>
        <path d="M5 12l7 7 7-7"/>
      </svg>
      <span>Quiz Catalog</span>
    </div>

    <!-- Title -->
    <h1 class="catalog-title">
      <span class="text-text-primary">Explore Our</span>
      <span class="gradient-text"> Quiz Collection</span>
    </h1>

    <p class="catalog-subtitle">
      Choose from hundreds of quizzes across various subjects and difficulty levels.
    </p>

    <!-- Search Bar -->
    <div class="search-wrapper">
      <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
      </svg>
      <input 
        type="text" 
        placeholder="Search quizzes..."
        class="search-input"
        [(ngModel)]="searchInput"
        (keyup.enter)="onSearch()"
        data-testid="search-input"
      />
    </div>

    <!-- Category Pills -->
    <div class="category-pills">
      <button 
        class="category-pill"
        [class.active]="!catalogState.filters().categoryId"
        (click)="onCategorySelect(null)"
        data-testid="filter-all">
        All
      </button>
      @for (category of staticCategories; track category.name) {
        <button 
          class="category-pill"
          [class.active]="catalogState.filters().categoryId === category.id"
          (click)="onCategorySelect(category.id)"
          [attr.data-testid]="'filter-category-' + category.id">
          {{ category.name }}
        </button>
      }
    </div>

    <!-- Difficulty + View Controls -->
    <div class="filter-controls">
      <div class="difficulty-filter">
        <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/>
        </svg>
        <span class="filter-label">Difficulty:</span>
        <button 
          class="diff-btn"
          [class.active]="!catalogState.filters().difficulty"
          (click)="onDifficultySelect(null)">
          All
        </button>
        <button 
          class="diff-btn"
          [class.active]="catalogState.filters().difficulty === 'EASY'"
          (click)="onDifficultySelect('EASY')">
          Easy
        </button>
        <button 
          class="diff-btn"
          [class.active]="catalogState.filters().difficulty === 'MEDIUM'"
          (click)="onDifficultySelect('MEDIUM')">
          Medium
        </button>
        <button 
          class="diff-btn"
          [class.active]="catalogState.filters().difficulty === 'HARD'"
          (click)="onDifficultySelect('HARD')">
          Hard
        </button>
      </div>

      <div class="view-toggle glass">
        <button 
          class="view-btn"
          [class.active]="viewMode === 'grid'"
          (click)="viewMode = 'grid'">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
          </svg>
        </button>
        <button 
          class="view-btn"
          [class.active]="viewMode === 'list'"
          (click)="viewMode = 'list'">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"/>
          </svg>
        </button>
      </div>
    </div>
  </header>

  <!-- Results Info -->
  <div class="results-info">
    <span>Showing <strong class="text-text-primary">{{ catalogState.totalElements() }}</strong> quizzes</span>
  </div>

  <!-- Loading State -->
  @if (catalogState.loading()) {
    <div class="loading-container">
      <ui-loader size="lg" text="Loading quizzes..." [centered]="true" />
    </div>
  }

  <!-- Error State -->
  @if (catalogState.error()) {
    <div class="error-container">
      <div class="error-card glass-strong">
        <svg class="error-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
        </svg>
        <p class="error-text">{{ catalogState.error() }}</p>
        <button class="retry-btn" (click)="catalogState.loadQuizzes()">Clear Filters</button>
      </div>
    </div>
  }

  <!-- Quiz Grid -->
  @if (!catalogState.loading() && !catalogState.error()) {
    <div class="quiz-grid" [class.list-view]="viewMode === 'list'" data-testid="quiz-grid">
      @for (quiz of catalogState.quizzes(); track quiz.id) {
        <a [routerLink]="['/quizzes', quiz.id]" class="quiz-card glass" [attr.data-testid]="'quiz-card-' + quiz.id">
          <!-- Card Icon -->
          <div class="card-header">
            <div class="card-icon">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
              </svg>
            </div>
            <ui-badge [variant]="getDifficultyVariant(quiz.difficulty)" size="sm">
              {{ getDifficultyLabel(quiz.difficulty) }}
            </ui-badge>
          </div>
          
          <!-- Content -->
          <div class="card-content">
            <span class="card-category">{{ quiz.categoryName }}</span>
            <h3 class="card-title">{{ quiz.title }}</h3>
            <p class="card-description">{{ quiz.description }}</p>
            
            <div class="card-meta">
              <span class="meta-item">
                <svg class="meta-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                {{ quiz.questionCount }} questions
              </span>
              <span class="meta-item">
                <svg class="meta-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                {{ quiz.timeLimit }} min
              </span>
            </div>
          </div>
        </a>
      } @empty {
        <div class="empty-state" data-testid="empty-state">
          <div class="empty-card glass-strong">
            <svg class="empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
            <h3 class="empty-title">No quizzes found</h3>
            <p class="empty-subtitle">Try adjusting your search or filters to find what you're looking for.</p>
            <button class="empty-action" (click)="onClearFilters()">Clear Filters</button>
          </div>
        </div>
      }
    </div>

    <!-- Load More -->
    @if (catalogState.hasMorePages()) {
      <div class="load-more-container">
        <button class="load-more-btn" (click)="onLoadMore()" data-testid="load-more">
          Load more quizzes
        </button>
      </div>
    }
  }
</div>
